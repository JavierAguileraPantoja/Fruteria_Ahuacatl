<%- include('layout/header') %>

<div class="container my-4">
  <div class="card shadow-lg">
    <div class="card-header bg-primary text-white">
      <h4><i class="fas fa-edit me-2"></i>Editar Producto</h4>
    </div>

    <div class="card-body">
      <!-- ALERTAS PROFESIONALES DE INVENTARIO -->
      <div class="mb-3">

        <% if (producto.stock <= 10) { %>
          <div class="alert alert-warning fw-semibold">
            ‚ö† El stock total est√° por agotarse: <%= producto.stock %> <%= producto.unidad %>.
          </div>
        <% } %>

        <% if (producto.stock_precio_viejo !== undefined && producto.stock_precio_viejo <= 5) { %>
          <div class="alert alert-danger fw-semibold">
            üî• El lote actual (precio viejo) est√° por agotarse: <%= producto.stock_precio_viejo %> <%= producto.unidad %>.
            <br>Cuando se agote, el precio cambiar√° autom√°ticamente a:
            <strong>$<%= producto.precio_nuevo %></strong>
          </div>
        <% } %>

        <% if (producto.stock_precio_nuevo > 0) { %>
          <div class="alert alert-info fw-semibold">
            ‚Ñπ Hay un lote nuevo pendiente:
            <%= producto.stock_precio_nuevo %> <%= producto.unidad %>
            a precio <strong>$<%= producto.precio_nuevo %></strong>.
          </div>
        <% } %>

      </div>


      <form action="/productos/edit/<%= producto._id %>" method="POST" enctype="multipart/form-data">

        <div class="row g-3">

          <div class="col-md-6">
            <label class="form-label fw-bold">Nombre</label>
            <input type="text" name="nombre" value="<%= producto.nombre %>" required class="form-control">
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">Categor√≠a</label>
            <input type="text" name="categoria" value="<%= producto.categoria %>" required class="form-control">
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">Precio compra</label>
            <input type="number" step="0.01" name="precio_compra" value="<%= producto.precio_compra %>" required class="form-control">
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">Precio venta</label>
            <input type="number" step="0.01" name="precio_venta" value="<%= producto.precio_venta %>" required class="form-control">
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">Unidad</label>
            <input type="text" name="unidad" value="<%= producto.unidad %>" required class="form-control">
          </div>

          <div class="col-md-6">
            <label class="form-label fw-bold">Imagen actual</label><br>
            <img src="/Uploads/<%= producto.imagen %>" width="120" class="rounded shadow-sm border mb-2">
            <input type="file" name="imagen" class="form-control mt-2">
          </div>

        </div>

        <div class="text-end mt-4">
          <a href="/productos" class="btn btn-secondary">Cancelar</a>
          <button class="btn btn-primary">Guardar cambios</button>
        </div>

      </form>

    </div>
  </div>
</div>

<%- include('layout/footer') %>
